# Mockc: Complie-time mock generator for Go
Mockc is a compile-time mock generator for Go. It simply parses your mock generators and creates mocks. Mockc is completely type safe. You can use it just by writing a mock generator with `mockc.Implements` and `mockc.SetMode`.

> This is beta release. This might have some bugs. Please submit your [issue](https://github.com/KimMachineGun/mockc/issues/new).

## Features
- [x] Mock creation
- [ ] Mock mode settings

## Installation
```
go get github.com/KimMachineGun/mockc/cmd/mockc
```

## Look and Feel
### 1. Create mock generator
#### interface example:
```go
package ex

type Parser interface {
	Parse(s string) (result string, err error)
	ParseBytes(b []byte) (result []byte, err error)
}
```
#### mock generator example:
```go
//+build mockc

package main

import (
	"github.com/KimMachineGun/mockc"

	ex "github.com/example/package"
)

func MockcExParser() {
	mockc.Implements(ex.Parser(nil))
}
```
### 2. Run `mockc`
```sh
mockc [<packages-pattern>]
```
### 3. Feel free to use the generated mock
```go
// Code generated by Mockc. DO NOT EDIT.
// repo: https://github.com/KimMachineGun/mockc

//go:generate mockc
//+build !mockc

package main

type MockcExParser struct {
	mockcs struct {
		// method: ParseBytes
		ParseBytes struct {
			// basics
			Called    bool
			CallCount int
			// last params
			Params struct {
				b []byte
			}
			// last results
			Results struct {
				result []byte
				err    error
			}
			// if Body is not nil, it is called in the middle of the method.
			Body func([]byte) ([]byte, error)
		}
		// method: Parse
		Parse struct {
			// basics
			Called    bool
			CallCount int
			// last params
			Params struct {
				s string
			}
			// last results
			Results struct {
				result string
				err    error
			}
			// if Body is not nil, it is called in the middle of the method.
			Body func(string) (string, error)
		}
	}
}

func (recv *MockcExParser) ParseBytes(b []byte) ([]byte, error) {
	// basics
	recv.mockcs.ParseBytes.Called = true
	recv.mockcs.ParseBytes.CallCount++
	// params
	recv.mockcs.ParseBytes.Params.b = b
	// body
	if recv.mockcs.ParseBytes.Body != nil {
		recv.mockcs.ParseBytes.Results.result, recv.mockcs.ParseBytes.Results.err = recv.mockcs.ParseBytes.Body(b)
	}
	// results
	return recv.mockcs.ParseBytes.Results.result, recv.mockcs.ParseBytes.Results.err
}

func (recv *MockcExParser) Parse(s string) (string, error) {
	// basics
	recv.mockcs.Parse.Called = true
	recv.mockcs.Parse.CallCount++
	// params
	recv.mockcs.Parse.Params.s = s
	// body
	if recv.mockcs.Parse.Body != nil {
		recv.mockcs.Parse.Results.result, recv.mockcs.Parse.Results.err = recv.mockcs.Parse.Body(s)
	}
	// results
	return recv.mockcs.Parse.Results.result, recv.mockcs.Parse.Results.err
}
```

## Inspired by üôè
- [github.com/google/wire](https://github.com/google/wire)
- [github.com/sasha-s/goimpl](https://github.com/sasha-s/goimpl)
- [github.com/vektra/mockery](https://github.com/vektra/mockery)
